import{d as $,u as j,s as I,r as V,c as b,a as l,b as t,e as h,f as n,w as G,g as S,t as i,n as f,h as w,i as g,F as T,j as F,o,k as x,_ as R}from"./index-Bua6_f4l.js";const z={class:"pb-20 bg-white dark:bg-slate-900 min-h-full transition-colors duration-300"},A={class:"sticky top-0 bg-white dark:bg-slate-900 z-20 pt-4 px-4 pb-2 transition-colors duration-300 shadow-sm"},P={key:0,class:"p-4 animate-fade-in"},B={class:"bg-slate-900 rounded-3xl p-6 border-4 border-double border-slate-700 shadow-2xl relative overflow-hidden magic-border"},Y={class:"space-y-6 relative z-10"},K={class:"flex justify-between text-xs font-bold text-red-400 mb-1 uppercase tracking-widest"},W={class:"h-3 bg-slate-800 rounded-full overflow-hidden border border-slate-700 relative"},H={class:"flex justify-between text-xs font-bold text-yellow-400 mb-1 uppercase tracking-widest"},L={class:"h-3 bg-slate-800 rounded-full overflow-hidden border border-slate-700 relative"},U={class:"flex justify-between text-xs font-bold text-green-400 mb-1 uppercase tracking-widest"},q={class:"h-3 bg-slate-800 rounded-full overflow-hidden border border-slate-700 relative"},J={class:"mt-8 text-center"},Q={class:"text-4xl font-rpg text-transparent bg-clip-text bg-gradient-to-b from-white to-slate-400 drop-shadow-lg"},X={class:"mt-4 bg-slate-50 dark:bg-slate-800/50 rounded-2xl p-4 border border-slate-200 dark:border-slate-700"},Z={class:"flex flex-wrap gap-2"},tt={key:0,class:"text-xs text-slate-400 italic"},et={key:1,class:"p-4 animate-fade-in"},st={class:"flex justify-between items-center mb-4"},at={class:"text-xs font-bold text-purple-500 bg-purple-100 dark:bg-purple-900/30 px-3 py-1 rounded-full border border-purple-200 dark:border-purple-800"},lt=["disabled"],ot={class:"space-y-4"},rt=["onClick"],nt={key:0,class:"absolute left-6 top-10 bottom-0 w-0.5 bg-slate-200 dark:bg-slate-700 -z-10 h-16"},it={key:0,class:"fas fa-lock"},dt={key:1,class:"fas fa-trophy animate-pulse"},ut={key:2,class:"fas fa-skull-crossbones"},ct={key:3,class:"fas fa-hourglass-half"},pt={key:4,class:"fas fa-bed"},bt={class:"flex-1"},ft={class:"flex justify-between items-center mb-1"},gt={class:"font-bold text-slate-700 dark:text-slate-200 text-sm"},xt={class:"text-xs font-normal text-slate-400"},vt={key:0,class:"ml-2 text-[10px] bg-purple-600 text-white px-1.5 py-0.5 rounded"},mt={class:"w-full bg-slate-100 dark:bg-slate-700 h-1.5 rounded-full overflow-hidden"},ht={class:"text-[10px] text-slate-400 mt-1 italic flex justify-between"},wt={key:0,class:"text-purple-400 opacity-0 group-hover:opacity-100 transition-opacity"},_t=$({__name:"AnalysisView",setup(kt){const d=j(),{analysisRefDate:_}=I(d),v=V("today"),m=b(()=>d.weeklyStats),C=b(()=>{const a=m.value;if(!a.length||!a[0]||!a[6])return"";const e=new Date(a[0].date),u=new Date(a[6].date);return`${e.getFullYear()}年${e.getMonth()+1}月${e.getDate()}日 - ${u.getMonth()+1}月${u.getDate()}日`}),N=b(()=>{const a=new Date,e=new Date(_.value),u=p=>{const s=p.getDay()||7,r=new Date(p);return r.setHours(0,0,0,0),r.setDate(r.getDate()-s+1),r};return u(e)>=u(a)}),c=b(()=>{const a=d.todayMacros,e=a.p+a.c+a.f||1;return{p:Math.round(a.p/e*100),c:Math.round(a.c/e*100),f:Math.round(a.f/e*100)}}),k=b(()=>d.todayLogs.slice(0,8)),M=a=>{switch(a){case"VICTORY":return"完美的胜利！Boss被击退。";case"DEFEAT":return"防线失守... Boss狂暴化！";case"ONGOING":return"战斗正在激烈进行中...";case"SKIPPED":return"英雄在营地休息。";default:return"未知的时空..."}},y=a=>{const[e,u,p]=_.value.split("-").map(Number),s=new Date(e||2024,(u||1)-1,p||1);s.setDate(s.getDate()+a*7);const r=s.getFullYear(),D=String(s.getMonth()+1).padStart(2,"0"),O=String(s.getDate()).padStart(2,"0");d.analysisRefDate=`${r}-${D}-${O}`},E=a=>{d.temp.selectedHistoryDate=a,d.setModal("historyDetail",!0)};return(a,e)=>{const u=S("van-tab"),p=S("van-tabs");return o(),l("div",z,[t("div",A,[e[3]||(e[3]=t("h2",{class:"text-xl font-rpg text-slate-800 dark:text-slate-100 mb-4 flex items-center"},[t("i",{class:"fas fa-scroll text-purple-600 mr-2"}),n(" 冒险手札 ")],-1)),h(p,{active:v.value,"onUpdate:active":e[0]||(e[0]=s=>v.value=s),type:"card",color:"#7c3aed",class:"w-full",background:"transparent"},{default:G(()=>[h(u,{title:"元素共鸣",name:"today"}),h(u,{title:"冒险编年史",name:"week"})]),_:1},8,["active"])]),v.value==="today"?(o(),l("div",P,[t("div",B,[e[12]||(e[12]=t("div",{class:"absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/dark-matter.png')] opacity-20"},null,-1)),e[13]||(e[13]=t("h3",{class:"font-bold text-slate-200 w-full mb-6 flex items-center justify-center relative z-10 text-lg font-rpg"},[t("i",{class:"fas fa-atom mr-2 text-purple-400 animate-spin-slow"}),n(" 元素魔力池 ")],-1)),t("div",Y,[t("div",null,[t("div",K,[e[4]||(e[4]=t("span",null,[t("i",{class:"fas fa-fire mr-1"}),n(" 力量之火 (Pro)")],-1)),t("span",null,i(c.value.p)+"%",1)]),t("div",W,[e[5]||(e[5]=t("div",{class:"absolute inset-0 bg-red-900/30"},null,-1)),t("div",{class:"h-full bg-gradient-to-r from-red-600 to-orange-500 shadow-[0_0_10px_rgba(239,68,68,0.5)] transition-all duration-1000",style:f({width:c.value.p+"%"})},null,4)])]),t("div",null,[t("div",H,[e[6]||(e[6]=t("span",null,[t("i",{class:"fas fa-bolt mr-1"}),n(" 敏捷之雷 (Carb)")],-1)),t("span",null,i(c.value.c)+"%",1)]),t("div",L,[e[7]||(e[7]=t("div",{class:"absolute inset-0 bg-yellow-900/30"},null,-1)),t("div",{class:"h-full bg-gradient-to-r from-yellow-500 to-amber-300 shadow-[0_0_10px_rgba(234,179,8,0.5)] transition-all duration-1000",style:f({width:c.value.c+"%"})},null,4)])]),t("div",null,[t("div",U,[e[8]||(e[8]=t("span",null,[t("i",{class:"fas fa-shield-alt mr-1"}),n(" 坚韧之土 (Fat)")],-1)),t("span",null,i(c.value.f)+"%",1)]),t("div",q,[e[9]||(e[9]=t("div",{class:"absolute inset-0 bg-green-900/30"},null,-1)),t("div",{class:"h-full bg-gradient-to-r from-green-600 to-emerald-400 shadow-[0_0_10px_rgba(16,185,129,0.5)] transition-all duration-1000",style:f({width:c.value.f+"%"})},null,4)])])]),t("div",J,[e[11]||(e[11]=t("div",{class:"text-[10px] text-slate-400 uppercase tracking-[0.2em] mb-1"},"Total Mana Output",-1)),t("div",Q,[n(i(w(d).todayMacros.cals)+" ",1),e[10]||(e[10]=t("span",{class:"text-sm text-slate-500"},"kcal",-1))])])]),t("div",X,[e[14]||(e[14]=t("h4",{class:"text-xs font-bold text-slate-500 uppercase mb-3"},"今日狩猎战利品",-1)),t("div",Z,[(o(!0),l(T,null,F(k.value,(s,r)=>(o(),l("span",{key:r,class:"px-2 py-1 bg-white dark:bg-slate-700 rounded border border-slate-100 dark:border-slate-600 text-xs text-slate-600 dark:text-slate-300 shadow-sm flex items-center"},i(s.icon)+" "+i(s.name),1))),128)),k.value.length===0?(o(),l("span",tt,"暂无记录...")):g("",!0)])])])):(o(),l("div",et,[t("div",st,[t("button",{onClick:e[1]||(e[1]=s=>y(-1)),class:"text-slate-400 hover:text-white px-2"},[...e[15]||(e[15]=[t("i",{class:"fas fa-chevron-left"},null,-1),n(" 上一章 ",-1)])]),t("span",at,i(C.value),1),t("button",{onClick:e[2]||(e[2]=s=>y(1)),disabled:N.value,class:"text-slate-400 hover:text-white disabled:opacity-30 px-2"},[...e[16]||(e[16]=[n(" 下一章 ",-1),t("i",{class:"fas fa-chevron-right"},null,-1)])],8,lt)]),t("div",ot,[(o(!0),l(T,null,F(m.value,(s,r)=>(o(),l("div",{key:r,class:"relative group",onClick:D=>!s.isFuture&&E(s.date)},[r<m.value.length-1?(o(),l("div",nt)):g("",!0),t("div",{class:x(["flex items-center bg-white dark:bg-slate-800 p-3 rounded-2xl border border-slate-100 dark:border-slate-700 shadow-sm transition-all",[s.isToday?"ring-2 ring-purple-500 ring-offset-2 ring-offset-slate-900":"",s.isFuture?"opacity-40 cursor-not-allowed grayscale":"cursor-pointer active:scale-95 hover:border-purple-300 dark:hover:border-purple-700"]])},[t("div",{class:x(["w-12 h-12 rounded-xl flex items-center justify-center text-2xl mr-4 shrink-0 shadow-inner",{"bg-slate-100 dark:bg-slate-700 text-slate-400":s.rpgStatus==="UNKNOWN"||s.rpgStatus==="SKIPPED","bg-green-100 dark:bg-green-900/30 text-green-600":s.rpgStatus==="VICTORY","bg-red-100 dark:bg-red-900/30 text-red-500":s.rpgStatus==="DEFEAT","bg-blue-100 dark:bg-blue-900/30 text-blue-500":s.rpgStatus==="ONGOING"}])},[s.isFuture?(o(),l("i",it)):s.rpgStatus==="VICTORY"?(o(),l("i",dt)):s.rpgStatus==="DEFEAT"?(o(),l("i",ut)):s.rpgStatus==="ONGOING"?(o(),l("i",ct)):(o(),l("i",pt))],2),t("div",bt,[t("div",ft,[t("div",gt,[n(i(s.label)+" ",1),t("span",xt,"周"+i(s.weekday),1),s.isToday?(o(),l("span",vt,"进行中")):g("",!0)]),t("div",{class:x(["text-xs font-bold font-mono",s.val>w(d).dailyTarget?"text-red-500":"text-slate-500"])},[n(i(s.val)+" ",1),e[17]||(e[17]=t("span",{class:"text-[10px]"},"kcal",-1))],2)]),t("div",mt,[t("div",{class:x(["h-full rounded-full",s.rpgStatus==="DEFEAT"?"bg-red-500":"bg-green-500"]),style:f({width:Math.min(s.val/w(d).dailyTarget*100,100)+"%"})},null,6)]),t("div",ht,[t("span",null,i(s.isFuture?"迷雾未散...":M(s.rpgStatus)),1),s.isFuture?g("",!0):(o(),l("span",wt,[...e[18]||(e[18]=[n("查看详情 ",-1),t("i",{class:"fas fa-chevron-right text-[8px]"},null,-1)])]))])])],2)],8,rt))),128))])]))])}}}),Dt=R(_t,[["__scopeId","data-v-d4ffb232"]]);export{Dt as default};
