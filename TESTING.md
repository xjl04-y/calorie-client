# 🧪 健康乐园 RPG - 完整测试指南

本文档提供详细的功能测试指南，帮助你全面测试应用的所有功能。

## 📋 测试前准备

### 环境检查

```bash
# 1. 检查 Node.js 版本
node --version  # 应该是 20.19+ 或 22.12+

# 2. 安装依赖
npm install

# 3. 启动开发服务器
npm run dev
```

### 推荐测试工具

- **浏览器**: Chrome 或 Edge（推荐安装 Vue Devtools）
- **设备**: 桌面浏览器 + 移动设备/模拟器
- **开发者工具**: F12 打开，查看 Console 和 Application > Local Storage

---

## 🎯 功能测试清单

### 1️⃣ 首次启动和新用户引导

#### 测试步骤

1. **清除本地数据**（模拟新用户）
   - 打开浏览器开发者工具 (F12)
   - 进入 Application > Local Storage
   - 删除所有 `rpg_*` 开头的键值对
   - 刷新页面

2. **欢迎引导**
   - ✅ 应显示开屏动画（如果启用）
   - ✅ 自动弹出新手引导弹窗

3. **纯净模式测试**
   - 选择"跳过选择，直接开始"
   - 填写个人信息：
     - 昵称：测试用户
     - 性别：任选
     - 年龄：25
     - 身高：170
     - 体重：65
   - ✅ 提交后进入主界面
   - ✅ 界面应显示为简洁的纯净模式风格

4. **RPG模式测试**
   - 清除数据重新开始
   - 观看种族卡牌动画
   - 点击任意种族卡片查看详情
   - 选择一个种族（例如：人类）
   - 填写冒险者档案（同上）
   - ✅ 提交后进入 RPG 风格主界面
   - ✅ 应显示角色状态栏（HP、经验、金币等）

#### 预期结果

- 引导流程流畅，无崩溃
- 数据成功保存到 localStorage
- 界面风格符合所选模式
- Console 无报错信息

---

### 2️⃣ 添加饮食记录

#### 测试场景 A：快速添加预设食物

1. **从主页添加早餐**
   - 点击"早餐"卡片
   - 在食物列表中选择"鸡蛋"
   - 输入数量：2（单位：个）
   - ✅ 确认添加后，记录应出现在今日饮食列表

2. **验证数据显示**
   - ✅ 主页顶部应显示今日热量增加
   - ✅ 蛋白质、碳水、脂肪数值更新
   - RPG模式：Boss 血量应减少

#### 测试场景 B：AI 智能识别（需配置后端）

1. 点击"午餐"卡片
2. 在搜索框输入：`一碗西红柿鸡蛋面`
3. 点击"搜索/AI识别"按钮
4. ✅ AI 应返回识别结果，包含热量和营养成分
5. 选择合适的选项添加

#### 测试场景 C：烹饪组合功能

1. 点击"晚餐"卡片
2. 搜索或选择"番茄炒蛋"（组合食物）
3. ✅ 应进入"烹饪模式"
4. 查看成分列表（鸡蛋、番茄等）
5. 调整分量后提交
6. ✅ 记录显示为组合食物

#### 测试场景 D：自定义食物

1. 点击任意餐次
2. 滚动到底部，点击"手动添加"
3. 填写自定义食物：
   - 名称：自制沙拉
   - 热量：300 kcal
   - 蛋白质：10g
   - 碳水：20g
   - 脂肪：15g
4. ✅ 确认添加成功

#### 验证要点

- [ ] 食物记录正确显示在列表中
- [ ] 营养数据计算准确
- [ ] 时间戳正确
- [ ] 可以点击记录查看详情
- [ ] 详情页可以编辑或删除

---

### 3️⃣ 添加运动记录

#### 测试步骤

1. **从浮动按钮添加**
   - 点击屏幕右侧的浮动按钮
   - 选择"运动训练"

2. **选择运动类型**
   - 选择"跑步"
   - 输入时长：30 分钟
   - 选择强度：中等
   - ✅ 确认添加

3. **验证消耗显示**
   - ✅ 主页应显示运动消耗热量
   - ✅ 今日目标热量应相应增加（基础BMR + 运动消耗）
   - RPG模式：应触发战斗动画和伤害计算

4. **测试其他运动类型**
   - 骑行：20分钟
   - 游泳：15分钟
   - 力量训练：40分钟
   - ✅ 不同运动的消耗值应有区别

#### 验证要点

- [ ] 运动记录正确保存
- [ ] 热量消耗计算合理
- [ ] 运动记录可查看、编辑、删除
- [ ] 在分析页能看到运动统计

---

### 4️⃣ 补水记录功能

#### 测试步骤

1. **打开补水弹窗**
   - 点击浮动按钮 → "补水记录"

2. **快速添加**
   - 选择预设饮品：白开水（250ml）
   - ✅ 确认添加

3. **自定义添加**
   - 选择"自定义"
   - 设置：绿茶、300ml、温
   - ✅ 确认添加

4. **查看补水进度**
   - ✅ 弹窗顶部显示今日饮水进度
   - ✅ 百分比和杯数正确

5. **查看记录详情**
   - 点击任意补水记录
   - ✅ 显示详细信息（时间、类型、温度等）
   - ✅ 可以删除记录

#### 验证要点

- [ ] 补水记录正确统计
- [ ] 目标设置功能可用
- [ ] 记录可以查看和管理
- [ ] 在分析页能看到补水趋势

---

### 5️⃣ 数据分析和统计

#### 测试步骤

1. **进入分析页**
   - 点击底部导航"统计/战报"标签

2. **查看今日数据**
   - ✅ 热量摄入趋势图
   - ✅ 营养素分布（蛋白质、碳水、脂肪）
   - ✅ 运动消耗统计
   - ✅ 补水记录

3. **切换日期**
   - 使用日期选择器切换到其他日期
   - ✅ 数据应相应更新

4. **查看体重趋势**
   - 滚动到"体重趋势"部分
   - ✅ 应显示历史体重曲线图
   - 点击"记录体重"
   - 输入新的体重数据：66kg
   - ✅ 图表应更新

5. **历史记录查看**
   - 滚动到"饮食记录"
   - ✅ 应显示所选日期的所有记录
   - 点击任意记录查看详情

#### 验证要点

- [ ] 图表正确渲染
- [ ] 数据统计准确
- [ ] 日期切换功能正常
- [ ] 历史记录完整显示
- [ ] RPG模式：战斗数据统计正确

---

### 6️⃣ 模式切换测试

#### 测试步骤

1. **进入设置**
   - 点击"英雄/我的"标签页
   - 点击右上角设置按钮 ⚙️

2. **切换到纯净模式**
   - 在"外观设置"中关闭"冒险模式"
   - ✅ 保存设置

3. **验证界面变化**
   - ✅ 主页去除 RPG 元素（Boss、战斗动画等）
   - ✅ 状态栏变为简洁样式
   - ✅ 导航栏文字更新（讨伐→饮食，战报→统计）
   - ✅ 个人页面显示健康数据而非角色属性

4. **切换回 RPG 模式**
   - 重新打开设置，启用"冒险模式"
   - ✅ RPG 元素恢复显示
   - ✅ 所有游戏数据保留（等级、金币、装备等）

#### 验证要点

- [ ] 模式切换流畅无卡顿
- [ ] 数据不丢失
- [ ] 界面适配正确
- [ ] Console 无错误

---

### 7️⃣ 深色模式测试

#### 测试步骤

1. **进入设置**
   - 设置 > 外观设置

2. **测试三种模式**

   **A. 浅色模式**
   - 选择"浅色主题"
   - ✅ 界面应为白色/浅色调
   - ✅ 文字清晰可读

   **B. 深色模式**
   - 选择"深色主题"
   - ✅ 界面应为深色/暗色调
   - ✅ 文字为浅色，对比度适中
   - ✅ 所有组件适配深色模式

   **C. 跟随系统**
   - 选择"跟随系统"
   - 修改系统主题设置
   - ✅ 应用应自动切换

#### 验证要点

- [ ] 三种模式都能正常工作
- [ ] 切换流畅无闪烁
- [ ] 所有页面和弹窗都正确适配
- [ ] 图表和图标颜色协调

---

### 8️⃣ RPG 系统测试（仅 RPG 模式）

#### 测试场景 A：等级和经验

1. **查看初始状态**
   - ✅ 等级 1，经验 0

2. **获取经验**
   - 添加多条饮食记录
   - 添加运动记录
   - ✅ 观察经验值增长

3. **升级**
   - 持续添加记录直到升级
   - ✅ 应弹出升级提示
   - ✅ 获得技能点
   - ✅ HP 和体力恢复

#### 测试场景 B：技能树

1. **打开技能树**
   - 个人页面 > 技能树

2. **学习技能**
   - 选择一个技能节点
   - 点击升级
   - ✅ 消耗技能点
   - ✅ 技能效果激活

3. **测试不同种族技能**
   - 人类：均衡发展
   - 精灵：经验加成
   - 兽人：高血量
   - 矮人：金币加成

#### 测试场景 C：装备系统

1. **查看成就**
   - 个人页面 > 成就

2. **解锁装备**
   - 完成特定成就（如连续登录、总热量等）
   - ✅ 解锁对应装备

3. **穿戴装备**
   - 点击装备位
   - 选择已解锁的装备
   - ✅ 属性加成生效（BMR、战力等）

#### 测试场景 D：任务系统

1. **打开任务面板**
   - 主页 > 点击"冒险者公会"

2. **接取任务**
   - 查看可用任务列表
   - 选择一个任务接取
   - ✅ 任务进入"执行中"

3. **完成任务**
   - 根据任务要求完成目标
   - ✅ 任务自动完成
   - ✅ 获得奖励（经验、金币）

4. **自定义任务**
   - 点击"自定委托"
   - 创建自定义目标
   - ✅ 任务添加成功

#### 测试场景 E：商店系统

1. **打开商店**
   - 个人页面 > 道具商店

2. **购买道具**
   - 选择一个道具（如生命药剂）
   - ✅ 消耗金币
   - ✅ 道具进入背包

3. **使用道具**
   - 个人页面 > 背包
   - 选择道具使用
   - ✅ 效果生效（如HP恢复）

4. **测试特殊道具**
   - 转生药水：切换种族
   - 技能重置书：重置技能
   - 盲盒：随机奖励

#### 测试场景 F：战斗系统

1. **触发战斗**
   - 添加运动记录
   - ✅ 观察战斗动画

2. **验证战斗机制**
   - ✅ 伤害计算正确
   - ✅ 暴击效果触发
   - ✅ 连击机制生效
   - ✅ Boss 血量减少

3. **测试特殊战斗效果**
   - 格挡
   - 闪避
   - 反伤
   - 吸血

#### 验证要点

- [ ] 所有 RPG 系统运行正常
- [ ] 数值计算准确
- [ ] 游戏平衡合理
- [ ] 动画效果流畅
- [ ] 音效和反馈及时

---

### 9️⃣ 数据管理测试

#### 测试场景 A：数据导出

1. **导出存档**
   - 设置 > 数据管理 > 导出存档
   - ✅ 应下载 JSON 文件
   - 文件名格式：`HEALTH_SAVE_[昵称]_[日期]`

2. **验证导出内容**
   - 用文本编辑器打开 JSON 文件
   - ✅ 应包含完整的用户数据、日志、设置等

#### 测试场景 B：数据导入

1. **导入存档**
   - 设置 > 数据管理 > 导入存档
   - 选择之前导出的 JSON 文件
   - ✅ 应提示导入成功

2. **验证数据恢复**
   - ✅ 用户信息恢复
   - ✅ 历史记录恢复
   - ✅ 设置恢复
   - RPG 模式：等级、金币、装备恢复

#### 测试场景 C：跨设备迁移

1. 在设备 A 导出数据
2. 将 JSON 文件传输到设备 B
3. 在设备 B 导入数据
4. ✅ 所有数据应完整迁移

#### 验证要点

- [ ] 导出功能正常
- [ ] 导入功能正常
- [ ] 数据完整性
- [ ] 兼容性良好

---

### 🔟 个人信息管理

#### 测试步骤

1. **修改基本信息**
   - 设置 > 冒险者档案/个人信息
   - 修改：
     - 昵称
     - 体重
     - 年龄
   - ✅ 保存成功

2. **验证 BMR 重新计算**
   - ✅ 修改体重后，每日目标热量应自动更新

3. **测试目标配置**
   - 设置 > 冒险者档案 > 目标配置
   - 切换目标模式：
     - 减重：目标热量降低
     - 增重：目标热量提高
     - 维持：保持当前水平
   - ✅ 每种模式的热量计算正确

4. **修改活动水平**
   - 选择不同的活动水平：
     - 久坐
     - 轻度活动
     - 中度活动
     - 重度活动
   - ✅ BMR 相应调整

#### 验证要点

- [ ] 信息修改保存成功
- [ ] BMR 计算准确
- [ ] 目标配置生效
- [ ] 界面实时更新

---

### 1️⃣1️⃣ 性能和稳定性测试

#### 测试场景 A：大量数据

1. **添加大量记录**
   - 连续添加 50+ 条饮食记录
   - 添加 20+ 条运动记录
   - ✅ 应用应保持流畅

2. **查看历史数据**
   - 切换不同日期
   - ✅ 数据加载快速
   - ✅ 图表渲染正常

#### 测试场景 B：长时间使用

1. 保持应用开启 30 分钟以上
2. 进行各种操作
3. ✅ 无内存泄漏
4. ✅ 无性能下降

#### 测试场景 C：离线使用

1. 断开网络连接
2. 尝试所有功能（AI 识别除外）
3. ✅ 核心功能应正常工作

#### 验证要点

- [ ] 无明显卡顿
- [ ] 内存使用稳定
- [ ] Console 无错误
- [ ] 数据不丢失

---

### 1️⃣2️⃣ 移动端测试（可选）

#### 测试环境

- 使用 Chrome DevTools 的移动设备模拟器
- 或在真实移动设备上测试

#### 测试要点

1. **响应式布局**
   - ✅ 界面适配不同屏幕尺寸
   - ✅ 文字大小合适
   - ✅ 按钮可点击

2. **触摸交互**
   - ✅ 滑动流畅
   - ✅ 点击响应快速
   - ✅ 弹窗操作便捷

3. **浮动按钮**
   - ✅ 可拖动
   - ✅ 位置记忆
   - ✅ 展开/收起正常

4. **Android 原生应用**（如果打包）
   - ✅ 启动正常
   - ✅ 返回键逻辑正确
   - ✅ 启动图显示

---

## 🐛 问题记录模板

测试时发现问题，请按以下格式记录：

```markdown
### 问题 [编号]：[简短描述]

**严重程度**：🔴 高 / 🟡 中 / 🟢 低

**复现步骤**：
1. 打开...
2. 点击...
3. 输入...
4. 观察到...

**预期结果**：应该...

**实际结果**：实际...

**环境信息**：
- 浏览器：Chrome 120
- 操作系统：Windows 11
- 应用模式：RPG / 纯净
- 主题：浅色 / 深色

**截图/录屏**：[如有]

**Console 错误信息**：
```
[粘贴错误信息]
```
```

---

## ✅ 测试完成检查清单

### 核心功能

- [ ] 新用户引导流程完整
- [ ] 饮食记录添加、查看、编辑、删除
- [ ] 运动记录添加、查看、编辑、删除
- [ ] 补水记录功能完整
- [ ] 数据统计和图表正确
- [ ] 体重记录和趋势图

### RPG 系统（RPG 模式）

- [ ] 升级系统
- [ ] 技能树
- [ ] 装备系统
- [ ] 任务系统
- [ ] 商店和道具
- [ ] 战斗系统
- [ ] 成就系统

### 系统功能

- [ ] 模式切换（RPG ↔ 纯净）
- [ ] 深色模式切换
- [ ] 数据导入导出
- [ ] 个人信息修改
- [ ] 目标配置
- [ ] 设置保存

### 性能和兼容性

- [ ] 桌面浏览器正常
- [ ] 移动端适配良好
- [ ] 性能稳定
- [ ] 数据持久化可靠

---

## 📊 测试报告示例

测试完成后，可以按以下格式整理：

```markdown
## 测试报告 - [日期]

### 测试环境
- 浏览器：Chrome 120.0.6099.129
- 操作系统：Windows 11
- Node.js：v20.10.0
- 应用版本：0.0.0

### 测试结果
- ✅ 通过：45 项
- ⚠️ 警告：2 项
- ❌ 失败：1 项

### 发现的问题
1. 🟡 [中] AI 识别偶尔超时
2. 🟢 [低] 深色模式下某些图标对比度略低
3. 🔴 [高] 大量数据时图表加载缓慢

### 优化建议
- 增加 AI 请求超时提示
- 调整深色模式图标颜色
- 优化图表渲染性能

### 总体评价
应用功能完整，大部分功能运行稳定，用户体验良好。建议修复上述问题后发布。
```

---

## 🎓 测试技巧

### 使用浏览器开发者工具

1. **Console 面板**
   - 查看日志输出
   - 检测 JavaScript 错误

2. **Application 面板**
   - 查看 localStorage 数据
   - 清除缓存和数据

3. **Network 面板**
   - 监控 API 请求（AI 识别）
   - 检查资源加载

4. **Performance 面板**
   - 录制性能分析
   - 查找性能瓶颈

### 快速重置数据

在 Console 中执行：

```javascript
// 清除所有本地数据
localStorage.clear();
location.reload();

// 或只清除特定数据
localStorage.removeItem('rpg_hero_data_v2');
```

### 快速添加测试数据

在 Console 中可以访问 Pinia Store：

```javascript
// 获取 store
const heroStore = window.$pinia.state.value.hero;

// 修改数据（仅用于测试）
heroStore.user.level = 10;
heroStore.user.gold = 9999;
```

---

## 📞 问题反馈

测试过程中遇到问题：

1. 记录详细的复现步骤
2. 截图或录屏
3. 导出相关数据（如果涉及）
4. 通过 GitHub Issues 反馈

---

**祝测试顺利！🎉**
