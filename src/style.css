/* å¼•å…¥ä¸»é¢˜å˜é‡ - å¿…é¡»åœ¨ @tailwind ä¹‹å‰ */
@import './styles/theme.css';

@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  /* [Capacitor æ ¸å¿ƒé€‚é…] å®šä¹‰ç§»åŠ¨ç«¯å®‰å…¨åŒºåŸŸå˜é‡ */
  --safe-area-top: env(safe-area-inset-top, 0px);
  --safe-area-bottom: env(safe-area-inset-bottom, 0px);
  --safe-area-left: env(safe-area-inset-left, 0px);
  --safe-area-right: env(safe-area-inset-right, 0px);

  --van-primary-color: #7c3aed; /* Magic Purple */
  --van-success-color: #10b981;
  --app-bg: #f8fafc;
  --rarity-common: #a3a3a3;
  --rarity-rare: #3b82f6;
  --rarity-epic: #a855f7;
  --rarity-legendary: #f59e0b;
}

/* =========================================
   å…¨å±€ä¸»é¢˜åŸºç¡€æ ·å¼
   ========================================= */
html {
  font-family: var(--font-family-base, 'Noto Sans SC', sans-serif);
  letter-spacing: var(--letter-spacing-base, 0);
  line-height: var(--line-height-base, 1.5);
}

body {
  font-family: inherit;
  background-color: var(--color-bg-base, var(--app-bg));
  color: var(--color-text-primary, #2d3436);
  overscroll-behavior-y: none;
  user-select: none;
  -webkit-tap-highlight-color: transparent;
  transition: background-color var(--transition-base, 0.3s),
              color var(--transition-base, 0.3s);
}

/* =========================================
   ğŸ° RPG ä¸»é¢˜ç‰¹æ®Šæ ·å¼
   ========================================= */
.theme-rpg body {
  background-image: var(--texture-paper), var(--texture-stone);
}

/* RPG æ¨¡å¼å¡ç‰‡æ ·å¼ */
.theme-rpg .theme-card {
  background: var(--color-bg-elevated);
  border: var(--border-main);
  border-radius: var(--radius-md);
  box-shadow: var(--shadow-md);
  position: relative;
}

.theme-rpg .theme-card::before {
  content: '';
  position: absolute;
  inset: 0;
  background: var(--texture-paper);
  border-radius: inherit;
  pointer-events: none;
  opacity: 0.5;
}

/* RPG æ¨¡å¼æŒ‰é’®æ ·å¼ */
.theme-rpg .theme-btn {
  background: var(--gradient-metal);
  border: 2px solid var(--border-color);
  border-radius: var(--radius-sm);
  box-shadow: var(--shadow-sm);
  color: var(--color-text-primary);
  font-family: var(--font-family-display);
  font-weight: var(--font-weight-bold);
  letter-spacing: var(--letter-spacing-wide);
  text-transform: uppercase;
  transition: all var(--transition-fast);
  position: relative;
  overflow: hidden;
}

.theme-rpg .theme-btn:hover {
  filter: brightness(var(--hover-brightness));
  border-color: var(--color-accent-primary);
}

.theme-rpg .theme-btn:active {
  transform: var(--btn-active-transform);
  box-shadow: var(--btn-active-shadow);
}

.theme-rpg .theme-btn-primary {
  background: var(--gradient-gold);
  color: var(--color-text-inverse);
  border-color: var(--color-accent-primary);
  text-shadow: 0 1px 2px rgba(0,0,0,0.3);
}

.theme-rpg .theme-btn-primary:hover {
  box-shadow: var(--shadow-glow);
}

/* RPG æ¨¡å¼è¾“å…¥æ¡† */
.theme-rpg .theme-input {
  background: var(--color-bg-sunken);
  border: var(--border-main);
  border-radius: var(--radius-sm);
  box-shadow: var(--shadow-inner);
  color: var(--color-text-primary);
  font-family: var(--font-family-base);
}

.theme-rpg .theme-input:focus {
  border-color: var(--color-accent-primary);
  box-shadow: var(--shadow-inner), var(--focus-ring);
}

.theme-rpg .theme-input::placeholder {
  color: var(--color-text-muted);
}

/* RPG å¼¹çª—æ ·å¼ */
.theme-rpg .theme-modal {
  background: var(--color-bg-elevated);
  border: 3px solid var(--border-color);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-xl), 0 0 60px rgba(0,0,0,0.5);
  position: relative;
}

.theme-rpg .theme-modal::before {
  content: '';
  position: absolute;
  inset: -3px;
  background: var(--gradient-gold);
  border-radius: inherit;
  z-index: -1;
  opacity: 0.3;
}

/* RPG æ ‡é¢˜æ ·å¼ */
.theme-rpg .theme-title {
  font-family: var(--font-family-display);
  color: var(--color-accent-primary);
  text-shadow: 2px 2px 0 var(--color-bg-base);
  letter-spacing: var(--letter-spacing-wide);
}

/* RPG åˆ†å‰²çº¿ */
.theme-rpg .theme-divider {
  height: 2px;
  background: linear-gradient(
    90deg,
    transparent 0%,
    var(--border-color) 20%,
    var(--color-accent-primary) 50%,
    var(--border-color) 80%,
    transparent 100%
  );
  border: none;
}

/* =========================================
   ğŸƒ Pure ä¸»é¢˜ç‰¹æ®Šæ ·å¼
   ========================================= */

/* Pure æ¨¡å¼å¡ç‰‡æ ·å¼ */
.theme-pure .theme-card {
  background: var(--color-bg-elevated);
  border: var(--border-main);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-md);
}

/* Pure æ¨¡å¼æŒ‰é’®æ ·å¼ */
.theme-pure .theme-btn {
  background: var(--color-bg-elevated);
  border: var(--border-main);
  border-radius: var(--radius-full);
  box-shadow: var(--shadow-sm);
  color: var(--color-text-primary);
  font-family: var(--font-family-base);
  font-weight: var(--font-weight-medium);
  transition: all var(--transition-base);
}

.theme-pure .theme-btn:hover {
  background: var(--color-bg-sunken);
  box-shadow: var(--shadow-md);
}

.theme-pure .theme-btn:active {
  transform: var(--btn-active-transform);
  box-shadow: var(--btn-active-shadow);
}

.theme-pure .theme-btn-primary {
  background: var(--color-accent-primary);
  color: var(--color-text-inverse);
  border: none;
  box-shadow: var(--shadow-md);
}

.theme-pure .theme-btn-primary:hover {
  background: var(--color-accent-secondary);
  box-shadow: var(--shadow-lg);
}

/* Pure æ¨¡å¼è¾“å…¥æ¡† */
.theme-pure .theme-input {
  background: var(--color-bg-sunken);
  border: var(--border-main);
  border-radius: var(--radius-md);
  color: var(--color-text-primary);
  font-family: var(--font-family-base);
  transition: all var(--transition-base);
}

.theme-pure .theme-input:focus {
  border-color: var(--color-accent-primary);
  box-shadow: var(--focus-ring);
  background: var(--color-bg-elevated);
}

.theme-pure .theme-input::placeholder {
  color: var(--color-text-muted);
}

/* Pure å¼¹çª—æ ·å¼ */
.theme-pure .theme-modal {
  background: var(--color-bg-elevated);
  border: none;
  border-radius: var(--radius-xl);
  box-shadow: var(--shadow-xl);
}

/* Pure æ ‡é¢˜æ ·å¼ */
.theme-pure .theme-title {
  font-family: var(--font-family-display);
  color: var(--color-text-primary);
  font-weight: var(--font-weight-bold);
}

/* Pure åˆ†å‰²çº¿ */
.theme-pure .theme-divider {
  height: 1px;
  background: var(--border-color);
  border: none;
}

/* =========================================
   é€šç”¨ç»„ä»¶åŠ¨ç”»
   ========================================= */

/* RPG æ¨¡å¼åŠ¨ç”»ï¼šæˆå‰§åŒ– */
.theme-rpg .theme-fade-enter-active {
  animation: rpg-fade-in 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
}

.theme-rpg .theme-fade-leave-active {
  animation: rpg-fade-out 0.2s ease-out;
}

@keyframes rpg-fade-in {
  0% {
    opacity: 0;
    transform: translateY(-10px) scale(0.95);
    filter: blur(4px);
  }
  100% {
    opacity: 1;
    transform: translateY(0) scale(1);
    filter: blur(0);
  }
}

@keyframes rpg-fade-out {
  0% {
    opacity: 1;
    transform: scale(1);
  }
  100% {
    opacity: 0;
    transform: scale(0.9);
  }
}

/* Pure æ¨¡å¼åŠ¨ç”»ï¼šå…‹åˆ¶å¹³é¡º */
.theme-pure .theme-fade-enter-active {
  animation: pure-fade-in 0.4s ease;
}

.theme-pure .theme-fade-leave-active {
  animation: pure-fade-out 0.3s ease;
}

@keyframes pure-fade-in {
  0% {
    opacity: 0;
    transform: translateY(8px);
  }
  100% {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes pure-fade-out {
  0% { opacity: 1; }
  100% { opacity: 0; }
}

/* æ·±è‰²æ¨¡å¼å˜é‡è¦†ç›– */
html.dark {
  --app-bg: #0f172a;
  --van-background-2: #1e293b;
  --van-text-color: #f8fafc;
  --van-popup-background: #1e293b;
  --van-toast-background: #334155;
  --van-toast-text-color: #f8fafc;
  --van-dialog-background: #1e293b;
  --van-dialog-text-color: #f8fafc;
}

body {
  font-family: 'Noto Sans SC', sans-serif;
  background-color: var(--app-bg);
  overscroll-behavior-y: none;
  user-select: none;
  -webkit-tap-highlight-color: transparent;
  transition: background-color 0.3s ease;

  /* æ³¨æ„ï¼šApp.vue ä¸­å·²ç»é€šè¿‡ .safe-area-top æ‰‹åŠ¨å¤„ç†äº†é¡¶éƒ¨é—´è· */
  /* è¿™é‡Œæˆ‘ä»¬ä¸ç»™ body åŠ  padding-topï¼Œé¿å…åŒé‡é—´è· */
}

/* ä½¿ç”¨å˜é‡å¢å¼ºé€šç”¨æ€§ */
.safe-area-top { padding-top: var(--safe-area-top); }
.safe-area-bottom { padding-bottom: var(--safe-area-bottom); }

.no-scrollbar::-webkit-scrollbar { display: none; }
.no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

.mobile-frame {
  height: 100vh;
  width: 100vw;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  position: relative;
}

/* å—ä¼¤è¦†ç›–å±‚ */
.damage-overlay {
  position: absolute; inset: 0; pointer-events: none; z-index: 9999;
  background: transparent;
}
.damage-active { animation: flash-red 0.5s ease-out; }
.screen-shaking { animation: screen-shake 0.5s cubic-bezier(.36,.07,.19,.97) both; }

/* é­”æ³•ç‰¹æ•ˆ */
.magic-border { position: relative; }
.magic-border::after {
  content: ''; position: absolute; inset: 0; border-radius: inherit; padding: 2px;
  background: linear-gradient(45deg, #7c3aed, #3b82f6, #ef4444);
  -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
  -webkit-mask-composite: xor; mask-composite: exclude; pointer-events: none; opacity: 0.5;
}

.magic-glow { box-shadow: 0 0 15px rgba(124, 58, 237, 0.5); animation: pulse-purple 2s infinite; }
@keyframes pulse-purple { 0% { box-shadow: 0 0 0 0 rgba(124, 58, 237, 0.4); } 70% { box-shadow: 0 0 0 10px rgba(124, 58, 237, 0); } 100% { box-shadow: 0 0 0 0 rgba(124, 58, 237, 0); } }

.stat-bar-overflow { background: repeating-linear-gradient(45deg, #ef4444, #ef4444 10px, #b91c1c 10px, #b91c1c 20px); }
.border-common { border-color: var(--rarity-common); }
.border-rare { border-color: var(--rarity-rare); box-shadow: 0 0 5px rgba(59, 130, 246, 0.3); }
.border-epic { border-color: var(--rarity-epic); box-shadow: 0 0 8px rgba(168, 85, 247, 0.4); }
.border-legendary { border-color: var(--rarity-legendary); box-shadow: 0 0 10px rgba(245, 158, 11, 0.5); animation: pulse-gold 3s infinite; }

@keyframes pulse-gold { 0% { box-shadow: 0 0 5px rgba(245, 158, 11, 0.4); } 50% { box-shadow: 0 0 15px rgba(245, 158, 11, 0.8); } 100% { box-shadow: 0 0 5px rgba(245, 158, 11, 0.4); } }

.anim-spin-slow { animation: spin-slow 10s linear infinite; }
.anim-rays { animation: spin-slow 20s linear infinite; }
.anim-pop { animation: pop-in 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
@keyframes spin-slow { 100% { transform: rotate(360deg); } }
@keyframes pop-in { 0% { transform: scale(0); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }
@keyframes float-boss { 0%, 100% { transform: translateY(0) scale(1); } 50% { transform: translateY(-10px) scale(1.05); } }
.anim-boss { animation: float-boss 4s ease-in-out infinite; }
.anim-hit { animation: shake-boss 0.5s ease-in-out; }
@keyframes shake-boss { 0%, 100% { transform: translate(0, 0) rotate(0); } 25% { transform: translate(-5px, 5px) rotate(-5deg); } 50% { transform: translate(5px, -5px) rotate(5deg); } 75% { transform: translate(-5px, -5px) rotate(-5deg); } }

/* Dark Mode Vant Overrides */
.dark .van-cell { background: #1e293b; color: white; }
.dark .van-cell::after { border-bottom-color: #334155; }
.dark .van-tabbar { background: #0f172a; border-top-color: #1e293b; }
.dark .van-tabbar-item { background: #0f172a; color: #94a3b8; }
.dark .van-tabbar-item--active { background: #1e293b; color: #a855f7; }
.dark .van-popup { background: #1e293b; color: #f8fafc; }
.dark .van-action-sheet { background: #1e293b; color: #f8fafc; }
.dark .van-slider__button { background: #f8fafc; }
.dark .van-calendar { background-color: #1e293b; }
.dark .van-calendar__header { box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
.dark .van-calendar__day { color: #e2e8f0; }
.dark .van-calendar__month-title { color: #fff; }
.dark .van-calendar__day--disabled { color: #475569; opacity: 0.3; pointer-events: none; }
.dark .van-tabs__nav { background: transparent; }
.dark .van-tab { color: #94a3b8; }
.dark .van-tab--active { color: #a855f7; font-weight: bold; }

.timeline-line { position: absolute; left: 19px; top: 30px; bottom: -20px; width: 2px; background: #334155; z-index: 0; }
.last-item .timeline-line { display: none; }

/* Tag Badges */
.tag-badge { font-size: 0.6rem; padding: 1px 4px; border-radius: 4px; font-weight: bold; margin-right: 4px; }
.tag-é«˜ç³–, .tag-HIGH_SUGAR { background: #fca5a5; color: #7f1d1d; border: 1px solid #fecaca; }
.tag-é«˜æ²¹, .tag-HIGH_FAT { background: #fde047; color: #854d0e; border: 1px solid #fef08a; }
.tag-é«˜ç›, .tag-HIGH_SODIUM { background: #cbd5e1; color: #334155; border: 1px solid #e2e8f0; }
.tag-é«˜ç¢³, .tag-HIGH_CARB { background: #fed7aa; color: #7c2d12; border: 1px solid #ffedd5; }
.tag-é«˜è›‹ç™½, .tag-HIGH_PRO { background: #86efac; color: #14532d; border: 1px solid #bbf7d0; }
.tag-çº¯å‡€, .tag-CLEAN { background: #cffafe; color: #155e75; border: 1px solid #a5f3fc; }
.tag-å‡è¡¡, .tag-BALANCED { background: #e9d5ff; color: #6b21a8; border: 1px solid #d8b4fe; }

.dark .tag-é«˜ç³–, .dark .tag-HIGH_SUGAR { background: #7f1d1d; color: #fca5a5; border-color: #991b1b; }
.dark .tag-é«˜æ²¹, .dark .tag-HIGH_FAT { background: #713f12; color: #fde047; border-color: #854d0e; }
.dark .tag-é«˜ç›, .dark .tag-HIGH_SODIUM { background: #334155; color: #cbd5e1; border-color: #475569; }
.dark .tag-é«˜ç¢³, .dark .tag-HIGH_CARB { background: #7c2d12; color: #fed7aa; border-color: #9a3412; }
.dark .tag-é«˜è›‹ç™½, .dark .tag-HIGH_PRO { background: #14532d; color: #86efac; border-color: #166534; }
.dark .tag-çº¯å‡€, .dark .tag-CLEAN { background: #164e63; color: #67e8f9; border-color: #0e7490; }
.dark .tag-å‡è¡¡, .dark .tag-BALANCED { background: #581c87; color: #d8b4fe; border-color: #6b21a8; }

/* Hero HP Bar */
.hero-hp-container {
  width: 100%; height: 8px; background: #0f172a; border-radius: 4px; overflow: hidden; margin-top: 4px; border: 1px solid #334155;
  position: relative;
}
.hero-hp-fill {
  height: 100%; background: linear-gradient(90deg, #ef4444, #dc2626); transition: width 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}
.hero-hp-text {
  position: absolute; top: -1px; left: 0; right: 0; bottom: 0; display: flex; align-items: center; justify-content: center;
  font-size: 8px; font-weight: bold; color: white; text-shadow: 0 1px 2px black;
}

/* === æ–°å¢ï¼šæ–°æ‰‹å¼•å¯¼èšå…‰ç¯ç‰¹æ•ˆ (Guide Spotlight) === */
.guide-overlay-mask {
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  z-index: 9990;
  pointer-events: none; /* è®© JS æ§åˆ¶ç‚¹å‡» */
  transition: all 0.4s cubic-bezier(0.25, 1, 0.5, 1);
  /* ä½¿ç”¨è¶…å¤§ Box-shadow æ¨¡æ‹Ÿé®ç½©æŒ–å­” */
  /* åˆå§‹çŠ¶æ€å…¨é»‘ï¼ŒJS åŠ¨æ€ä¿®æ”¹ */
}

/* é«˜äº®æ¡†çš„åŸºç¡€æ ·å¼ */
.guide-spotlight {
  position: absolute;
  box-shadow: 0 0 0 9999px rgba(0, 0, 0, 0.75); /* æ ¸å¿ƒé­”æ³•ï¼šç”¨é˜´å½±è¦†ç›–å…¨å± */
  border-radius: 12px;
  border: 2px solid rgba(124, 58, 237, 0.8); /* äº®è¾¹ */
  transition: all 0.4s cubic-bezier(0.25, 1, 0.5, 1);
  pointer-events: none;
  z-index: 9991;
  animation: spotlight-pulse 2s infinite;
}

@keyframes spotlight-pulse {
  0% { box-shadow: 0 0 0 9999px rgba(0, 0, 0, 0.75); border-color: rgba(124, 58, 237, 0.5); }
  50% { box-shadow: 0 0 0 9999px rgba(0, 0, 0, 0.65); border-color: rgba(124, 58, 237, 1); }
  100% { box-shadow: 0 0 0 9999px rgba(0, 0, 0, 0.75); border-color: rgba(124, 58, 237, 0.5); }
}

.typing-cursor::after {
  content: '|';
  animation: blink 1s step-start infinite;
}
@keyframes blink { 50% { opacity: 0; } }
